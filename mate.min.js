/* @preserve
Mate
https://github.com/zhanzhenzhen/mate
(c) 2013 Zhenzhen Zhan
Mate may be freely distributed under the MIT license.
 */
(function(){var $mate,featureLoaders,__indexOf=[].indexOf||function(t){for(var e=0,r=this.length;e<r;e++){if(e in this&&this[e]===t)return e}return-1},__hasProp={}.hasOwnProperty,__extends=function(t,e){for(var r in e){if(__hasProp.call(e,r))t[r]=e[r]}function n(){this.constructor=t}n.prototype=e.prototype;t.prototype=new n;t.__super__=e.prototype;return t};featureLoaders=[];$mate={};$mate.environmentType=typeof exports!=="undefined"&&exports!==null&&(typeof module!=="undefined"&&module!==null?module.exports:void 0)!=null?"node":typeof window!=="undefined"&&window!==null?"browser":void 0;$mate.enableAllFeatures=function(){if($mate.environmentType==="browser"){window.global=window}global.$mate=$mate;return featureLoaders.forEach(function(t){return t()})};featureLoaders.push(function(){var t;t=function(){function t(t,e,r){this._value=t;this._chain=(e!=null?e:[]).slice(0);if(r!=null){this._chain.push(r)}Object.getter(this,"length",function(t){return function(){return t.force().length}}(this))}t.prototype.force=function(){var t,e,r,n,i;e=this._value;i=this._chain;for(r=0,n=i.length;r<n;r++){t=i[r];e=t.fun.apply(e,t.args)}return e};t.prototype.map=function(){return this._pushChain(Array.prototype.map,arguments)};t.prototype.filter=function(){return this._pushChain(Array.prototype.filter,arguments)};t.prototype.concat=function(){return this._pushChain(Array.prototype.concat,arguments)};t.prototype.portion=function(){return this._pushChain(Array.prototype.portion,arguments)};t.prototype.funSort=function(){return this._pushChain(Array.prototype.funSort,arguments)};t.prototype.funSortDescending=function(){return this._pushChain(Array.prototype.funSortDescending,arguments)};t.prototype.funReverse=function(){return this._pushChain(Array.prototype.funReverse,arguments)};t.prototype.except=function(){return this._pushChain(Array.prototype.except,arguments)};t.prototype.group=function(){return this._pushChain(Array.prototype.group,arguments)};t.prototype.flatten=function(){return this._pushChain(Array.prototype.flatten,arguments)};t.prototype.random=function(){return this._pushChain(Array.prototype.random,arguments)};t.prototype.some=function(){return this._unwrapAndDo(Array.prototype.some,arguments)};t.prototype.every=function(){return this._unwrapAndDo(Array.prototype.every,arguments)};t.prototype.isEmpty=function(){return this._unwrapAndDo(Array.prototype.isEmpty,arguments)};t.prototype.at=function(){return this._unwrapAndDo(Array.prototype.at,arguments)};t.prototype.atOrNull=function(){return this._unwrapAndDo(Array.prototype.atOrNull,arguments)};t.prototype.contains=function(){return this._unwrapAndDo(Array.prototype.contains,arguments)};t.prototype.first=function(){return this._unwrapAndDo(Array.prototype.first,arguments)};t.prototype.firstOrNull=function(){return this._unwrapAndDo(Array.prototype.firstOrNull,arguments)};t.prototype.last=function(){return this._unwrapAndDo(Array.prototype.last,arguments)};t.prototype.lastOrNull=function(){return this._unwrapAndDo(Array.prototype.lastOrNull,arguments)};t.prototype.single=function(){return this._unwrapAndDo(Array.prototype.single,arguments)};t.prototype.singleOrNull=function(){return this._unwrapAndDo(Array.prototype.singleOrNull,arguments)};t.prototype.withMax=function(){return this._unwrapAndDo(Array.prototype.withMax,arguments)};t.prototype.withMin=function(){return this._unwrapAndDo(Array.prototype.withMin,arguments)};t.prototype.max=function(){return this._unwrapAndDo(Array.prototype.max,arguments)};t.prototype.min=function(){return this._unwrapAndDo(Array.prototype.min,arguments)};t.prototype.sum=function(){return this._unwrapAndDo(Array.prototype.sum,arguments)};t.prototype.average=function(){return this._unwrapAndDo(Array.prototype.average,arguments)};t.prototype.median=function(){return this._unwrapAndDo(Array.prototype.median,arguments)};t.prototype.product=function(){return this._unwrapAndDo(Array.prototype.product,arguments)};t.prototype.randomOne=function(){return this._unwrapAndDo(Array.prototype.randomOne,arguments)};t.prototype._pushChain=function(e,r){return new t(this._value,this._chain,{fun:e,args:r})};t.prototype._unwrapAndDo=function(t,e){return t.apply(this.force(),e)};return t}();Array._elementOrUseSelector=function(t,e){if(e!=null){return e(t)}else{return t}};Array.prototype._numberToIndex=function(t){if(0<t&&t<1){return t=Math.round(t*(this.length-1))}else{return t}};Array.prototype._numberToLength=function(t){if(0<t&&t<1){return t=Math.round(t*this.length)}else{return t}};Array.prototype.copy=function(){return this.slice(0)};Array.prototype.isEmpty=function(){return this.length===0};Array.prototype.lazy=function(){return new t(this)};Array.prototype.portion=function(t,e,r){if(Number.isFraction(t)||Number.isFraction(e)||Number.isFraction(r)){if(t===0){t=0+Number.EPSILON}if(t===1){t=1-Number.EPSILON}if(e===0){e=0+Number.EPSILON}if(e===1){e=1-Number.EPSILON}if(r===0){r=0+Number.EPSILON}if(r===1){r=1-Number.EPSILON}}t=this._numberToIndex(t);e=this._numberToLength(e);r=this._numberToIndex(r);return this.slice(t,e!=null?t+e:r+1)};Array.prototype.at=function(t){t=this._numberToIndex(t);assert(0<=t&&t<this.length);return this[t]};Array.prototype.atOrNull=function(t){try{return this.at(t)}catch(t){return null}};Array.prototype.contains=function(t){return __indexOf.call(this,t)>=0};Array.prototype.first=function(t){var e;e=t!=null?this.filter(t):this;return e.at(0)};Array.prototype.firstOrNull=function(t){try{return this.first(t)}catch(t){return null}};Array.prototype.last=function(t){var e;e=t!=null?this.filter(t):this;return e.at(e.length-1)};Array.prototype.lastOrNull=function(t){try{return this.last(t)}catch(t){return null}};Array.prototype.single=function(t){var e;e=t!=null?this.filter(t):this;assert(e.length===1);return e.at(0)};Array.prototype.singleOrNull=function(t){try{return this.single(t)}catch(t){return null}};Array.prototype.withMax=function(t){return this.reduce(function(e){return function(e,r,n){if(Array._elementOrUseSelector(e,t)>Array._elementOrUseSelector(r,t)){return e}else{return r}}}(this))};Array.prototype.withMin=function(t){return this.reduce(function(e){return function(e,r,n){if(Array._elementOrUseSelector(e,t)<Array._elementOrUseSelector(r,t)){return e}else{return r}}}(this))};Array.prototype.max=function(t){return Array._elementOrUseSelector(this.withMax(t),t)};Array.prototype.min=function(t){return Array._elementOrUseSelector(this.withMin(t),t)};Array.prototype.sum=function(t){if(this.length===1){return Array._elementOrUseSelector(this.first(),t)}else{return this.reduce(function(e){return function(e,r,n){return(n===1?Array._elementOrUseSelector(e,t):e)+Array._elementOrUseSelector(r,t)}}(this))}};Array.prototype.average=function(t){return this.sum(t)/this.length};Array.prototype.median=function(t){var e,r,n,i,o;o=this.funSort(t);e=o.at(.5-Number.EPSILON);r=o.at(.5+Number.EPSILON);n=Array._elementOrUseSelector(e,t);i=Array._elementOrUseSelector(r,t);return(n+i)/2};Array.prototype.product=function(t){if(this.length===1){return Array._elementOrUseSelector(this.first(),t)}else{return this.reduce(function(e){return function(e,r,n){return(n===1?Array._elementOrUseSelector(e,t):e)*Array._elementOrUseSelector(r,t)}}(this))}};Array.prototype.group=function(t,e){var r,n,i,o,u,s,a,l;if(this.isEmpty()){return[]}s=this.funSort(t);u=[];r=Array._elementOrUseSelector(s.first(),t);n=[];for(a=0,l=s.length;a<l;a++){o=s[a];i=Array._elementOrUseSelector(o,t);if(i!==r){u.push([r,Array._elementOrUseSelector(n,e)]);r=i;n=[]}n.push(o)}u.push([r,Array._elementOrUseSelector(n,e)]);return u};Array.prototype._sort=function(t,e){return this.copy().sort(function(r){return function(r,n){var i,o;i=Array._elementOrUseSelector(r,t);o=Array._elementOrUseSelector(n,t);if(i<o){if(e){return 1}else{return-1}}else if(i>o){if(e){return-1}else{return 1}}else{return 0}}}(this))};Array.prototype.funSort=function(t){return this._sort(t,false)};Array.prototype.funSortDescending=function(t){return this._sort(t,true)};Array.prototype.funReverse=function(){return this.copy().reverse()};Array.prototype.except=function(t){return this.filter(function(e){return __indexOf.call(t,e)<0})};Array.prototype.flatten=function(t){var e,r,n,i,o,u,s,a;if(t<=0){return fail()}else{i=[];e=false;for(o=0,s=this.length;o<s;o++){r=this[o];if(Array.isArray(r)){e=true;for(u=0,a=r.length;u<a;u++){n=r[u];i.push(n)}}else{i.push(r)}}if(e){if(t!=null){if(t===1){return i}else{return i.flatten(t-1)}}else{return i.flatten()}}else{return i}}};Array.prototype.randomOne=function(){return this[Math.randomInt(this.length)]};Array.prototype.random=function(t){return this.copy().takeRandom(t)};Array.prototype.takeRandomOne=function(){var t,e;t=Math.randomInt(this.length);e=this[t];this.removeAt(t);return e};Array.prototype.takeRandom=function(t){if(t==null){t=this.length}t=this._numberToLength(t);return repeat(t,function(t){return function(){return t.takeRandomOne()}}(this))};Array.prototype.removeAt=function(t){this.splice(t,1);return this};Array.prototype.remove=function(t){var e;e=this.indexOf(t);assert(e>-1);return this.removeAt(e)};Array.prototype.removeAll=function(t){var e;while(true){e=this.indexOf(t);if(e===-1){break}this.removeAt(e)}return this};Array.prototype.removeMatch=function(t){var e;e=this.findIndex(t);assert(e>-1);return this.removeAt(e)};return Array.prototype.removeAllMatch=function(t){var e;while(true){e=this.findIndex(t);if(e===-1){break}this.removeAt(e)}return this}});featureLoaders.push(function(){if(Number.EPSILON===void 0){Number.EPSILON=2.220446049250313e-16}if(Number.isInteger===void 0){Number.isInteger=function(t){return typeof t==="number"&&isFinite(t)&&t>-9007199254740992&&t<9007199254740992&&Math.floor(t)===t}}if(String.prototype.startsWith===void 0){String.prototype.startsWith=function(t){return this.indexOf(t)===0}}if(String.prototype.endsWith===void 0){String.prototype.endsWith=function(t){return this.lastIndexOf(t)===this.length-t.length}}if(String.prototype.contains===void 0){String.prototype.contains=function(t){return this.indexOf(t)!==-1}}if(Array.from===void 0){Array.from=function(t){var e,r,n,i;i=[];for(r=0,n=t.length;r<n;r++){e=t[r];i.push(e)}return i}}if(Array.prototype.find===void 0){Array.prototype.find=function(t){var e;assert(typeof t==="function");e=this.filter(t);if(!e.isEmpty()){return e.at(0)}else{return void 0}}}if(Array.prototype.findIndex===void 0){Array.prototype.findIndex=function(t){var e;e=this.find(t);if(e===void 0){return-1}else{return this.indexOf(e)}}}if(Math.sign===void 0){Math.sign=function(t){if(typeof t==="number"){if(t===0){return 0}else if(t>0){return 1}else if(t<0){return-1}else{return NaN}}else{return NaN}}}if(global.setImmediate===void 0){global.setImmediate=function(t,e){return setTimeout(t,0,e)}}if(global.clearImmediate===void 0){return global.clearImmediate=clearTimeout}});featureLoaders.push(function(){global.compose=function(t){if(arguments.length>1){t=Array.from(arguments)}return function(){var e,r,n,i;e=arguments;for(n=0,i=t.length;n<i;n++){r=t[n];e=[r.apply(this,e)]}return e[0]}};global.fail=function(t){throw new Error(t)};global.assert=function(t,e){if(!t){return fail(e)}};global.repeat=function(t,e){var r,n,i,o;if(typeof t==="number"){i=[t,e],e=i[0],t=i[1]}o=[];for(r=n=0;0<=e?n<e:n>e;r=0<=e?++n:--n){o.push(t())}return o};global.spread=function(t,e){var r,n,i;i=[];for(r=n=0;0<=e?n<e:n>e;r=0<=e?++n:--n){i.push(t)}return i};Object.getter=function(t,e,r){return Object.defineProperty(t,e,{get:r,configurable:true})};Object.setter=function(t,e,r){return Object.defineProperty(t,e,{set:r,configurable:true})};Object.clone=function(t){var e,r,n,i,o;r={};o=Object.keys(t);for(n=0,i=o.length;n<i;n++){e=o[n];r[e]=t[e]}return r};JSON.clone=function(t){return JSON.parse(JSON.stringify(t))};String.prototype.matches=function(t){var e,r,n;e=new RegExp(t.source,"g");n=[];while(true){r=e.exec(this);if(r!=null){n.push(r)}else{break}}return n};String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.substr(1)};Date.prototype.add=function(t){return new Date(this- -t)};Date.prototype.subtract=function(t){if(typeof t==="number"){return new Date(this-t)}else{return this-t}};Date.prototype.equals=function(t){return t<=this&&this<=t};console.logt=function(){return console.log.apply(null,[(new Date).toISOString()].concat(Array.from(arguments)))};global.eventField=function(){var t;t=function(e,r){if(typeof e==="function"){r=e;e="bind"}assert(typeof e==="string");t[e](r);return this};t._listeners=[];t.bind=function(e){if(__indexOf.call(t._listeners,e)<0){t._listeners.push(e)}return t};t.unbind=function(e){t._listeners.removeAll(e);return t};t.fire=function(e){var r,n,i,o;o=t._listeners;for(n=0,i=o.length;n<i;n++){r=o[n];if(e!=null?e.blocksListeners:void 0){break}r(e)}return void 0};return t};return global.EventedObject=function(){function t(){this._eventList={}}t.prototype.on=function(t,e){var r;if((r=this._eventList)[t]==null){r[t]=[]}if(__indexOf.call(this._eventList[t],e)<0){this._eventList[t].push(e)}return this};t.prototype.off=function(t,e){this._eventList[t].removeAll(e);return this};t.prototype.fire=function(t,e){var r,n,i,o,u;if((n=this._eventList)[t]==null){n[t]=[]}u=this._eventList[t];for(i=0,o=u.length;i<o;i++){r=u[i];r(e)}return void 0};t.prototype.listeners=function(t){return this._eventList[t]};return t}()});featureLoaders.push(function(){Math.nearlyEquals=function(t,e){var r,n;r=1+1/65536;return 1/r<(n=t/e)&&n<r};Math.nearlyGreaterThan=function(t,e){return t>e||Math.nearlyEquals(t,e)};Math.nearlyLessThan=function(t,e){return t<e||Math.nearlyEquals(t,e)};Math.radiansToDegrees=function(t){return t/Math.PI*180};Math.degreesToRadians=function(t){return t/180*Math.PI};Math.principalRadians=function(t){var e;e=t%(2*Math.PI);if(e<=-Math.PI){return e+2*Math.PI}else if(e>Math.PI){return e-2*Math.PI}else{return e}};Math.principalDegrees=function(t){var e;e=t%360;if(e<=-180){return e+360}else if(e>180){return e-360}else{return e}};Math.randomNumber=function(t,e){if(t<e){return t+Math.random()*(e-t)}else{return fail()}};Math.randomInt=function(t,e){var r,n;n=e===void 0?0:t;r=e===void 0?t:e;return Math.floor(Math.randomNumber(n,r))};Number.isFraction=function(t){return typeof t==="number"&&isFinite(t)&&Math.floor(t)!==t};Number.parseFloatExt=function(t){return parseFloat(t)*(t.endsWith("%")?.01:1)};Number.prototype.nearlyEquals=function(t){return Math.nearlyEquals(this,t)};Number.prototype.nearlyGreaterThan=function(t){return Math.nearlyGreaterThan(this,t)};Number.prototype.nearlyLessThan=function(t){return Math.nearlyLessThan(this,t)};global.Point=function(){function t(t,e){this.x=t;this.y=e}t.from=function(e){if(typeof e==="number"){return new t(e,0)}else if(e instanceof t){return e.clone()}else if(typeof e==="string"){return t.fromString(e)}else if(Array.isArray(e)){return t.fromArray(e)}else{return fail()}};t.fromArray=function(e){return new t(e[0],e[1])};t.fromString=function(e){var r,n,i,o,u,s,a;r=e.replace(/[\x20()]/g,"");o=r.match(/^([^,]*),(.*)$/);if(o!=null){return new t(Number.parseFloatExt(o[1]),Number.parseFloatExt(o[2]))}else{n=r.match(/^([+-]?[0-9]*\.?[0-9]*(?:[Ee][+-]?[0-9]+)?(?![i0-9Ee.]))?(?:([+-]?[0-9]*\.?[0-9]*(?:[Ee][+-]?[0-9]+)?)i)?$/);if(n!=null){u=(s=n[1])!=null?s:"0";i=(a=n[2])!=null?a:"0";if(u===""){u="1"}if(i===""){i="1"}if(u==="+"){u="1"}if(i==="+"){i="1"}if(u==="-"){u="-1"}if(i==="-"){i="-1"}return new t(parseFloat(u),parseFloat(i))}else{return fail()}}};t.fromPolar=function(e,r){return new t(e*Math.cos(r),e*Math.sin(r))};t.fromPolarInDegrees=function(e,r){switch(Math.principalDegrees(r)){case 0:return new t(e,0);case 90:return new t(0,e);case-90:return new t(0,-e);case 180:return new t(-e,0);default:return t.fromPolar(e,Math.degreesToRadians(r))}};t.prototype.real=function(){return this.x};t.prototype.imaginary=function(){return this.y};t.prototype.toString=function(){return"("+this.x+","+this.y+")"};t.prototype.toComplexString=function(){var t;t=this.y>=0?"+":"-";return""+this.x+t+Math.abs(this.y)+"i"};t.prototype.clone=function(){return new t(this.x,this.y)};t.prototype.equals=function(t){return cmath.equals(this,t)};t.prototype.nearlyEquals=function(t){return cmath.nearlyEquals(this,t)};t.prototype.opposite=function(){return cmath.opposite(this)};t.prototype.reciprocal=function(){return cmath.reciprocal(this)};t.prototype.conjugate=function(){return cmath.conjugate(this)};t.prototype.abs=function(){return cmath.abs(this)};t.prototype.add=function(t){return cmath.add(this,t)};t.prototype.subtract=function(t){return cmath.subtract(this,t)};t.prototype.multiply=function(t){return cmath.multiply(this,t)};t.prototype.divide=function(t){return cmath.divide(this,t)};t.prototype.distance=function(t){return cmath.distance(this,t)};t.prototype.dotProduct=function(e){e=t.from(e);return this.x*e.x+this.y*e.y};t.prototype.crossProduct=function(e){e=t.from(e);return this.x*e.y-this.y*e.x};t.prototype.isOppositeTo=function(t){return this.opposite().equals(t)};t.prototype.phase=function(){return cmath.phase(this)};t.prototype.phaseTo=function(e){e=t.from(e);return Math.principalRadians(e.phase()-this.phase())};t.prototype.phaseInDegrees=function(){return cmath.phaseInDegrees(this)};t.prototype.phaseInDegreesTo=function(e){e=t.from(e);return Math.principalDegrees(e.phaseInDegrees()-this.phaseInDegrees())};t.prototype.scale=function(e){e=t.from(e);return new t(this.x*e.x,this.y*e.y)};t.prototype.rotate=function(e){return this.multiply(t.fromPolar(1,e))};t.prototype.rotateDegrees=function(e){return this.multiply(t.fromPolarInDegrees(1,e))};return t}();return global.cmath={equals:function(t,e){t=Point.from(t);e=Point.from(e);return t.x===e.x&&t.y===e.y},nearlyEquals:function(t,e){t=Point.from(t);e=Point.from(e);return t.x.nearlyEquals(e.x)&&t.y.nearlyEquals(e.y)},opposite:function(t){t=Point.from(t);return new Point(-t.x,-t.y)},reciprocal:function(t){var e;t=Point.from(t);e=t.x*t.x+t.y*t.y;return new Point(t.x/e,-t.y/e)},conjugate:function(t){t=Point.from(t);return new Point(t.x,-t.y)},abs:function(t){t=Point.from(t);if(t.x===0){return Math.abs(t.y)}else if(t.y===0){return Math.abs(t.x)}else{return Math.sqrt(t.x*t.x+t.y*t.y)}},phase:function(t){t=Point.from(t);return Math.atan2(t.y,t.x)},phaseInDegrees:function(t){var e;t=Point.from(t);if(t.x===0&&t.y===0){return 0}else if(t.x===0&&t.y>0){return 90}else if(t.x===0&&t.y<0){return-90}else if(t.x>0&&t.y===0){return 0}else if(t.x<0&&t.y===0){return 180}else{e=Math.radiansToDegrees(cmath.phase(t));if(e<=-180){return 180}else{return e}}},add:function(t,e){t=Point.from(t);e=Point.from(e);return new Point(t.x+e.x,t.y+e.y)},subtract:function(t,e){return cmath.add(t,cmath.opposite(e))},multiply:function(t,e){t=Point.from(t);e=Point.from(e);return new Point(t.x*e.x-t.y*e.y,t.x*e.y+t.y*e.x)},divide:function(t,e){return cmath.multiply(t,cmath.reciprocal(e))},distance:function(t,e){return cmath.abs(cmath.subtract(t,e))},exp:function(t){t=Point.from(t);return Point.fromPolar(Math.exp(t.x),t.y)},log:function(t){return new Point(Math.log(cmath.abs(t)),cmath.phase(t))},pow:function(t,e){return cmath.exp(cmath.multiply(cmath.log(t),e))},sqrt:function(t){var e;t=Point.from(t);e=cmath.abs(t);return new Point(Math.sqrt((e+t.x)/2),Math.sign(t.y)*Math.sqrt((e-t.x)/2))},cos:function(t){return cmath.divide(cmath.add(cmath.exp(cmath.multiply(t,new Point(0,1))),cmath.exp(cmath.multiply(cmath.opposite(t),new Point(0,1)))),2)},sin:function(t){return cmath.divide(cmath.subtract(cmath.exp(cmath.multiply(t,new Point(0,1))),cmath.exp(cmath.multiply(cmath.opposite(t),new Point(0,1)))),new Point(0,2))},tan:function(t){return cmath.divide(cmath.sin(t),cmath.cos(t))},acos:function(t){return cmath.opposite(cmath.multiply(cmath.log(cmath.add(t,cmath.multiply(cmath.sqrt(cmath.add(cmath.opposite(cmath.multiply(t,t)),1)),new Point(0,1)))),new Point(0,1)))},asin:function(t){return cmath.opposite(cmath.multiply(cmath.log(cmath.add(cmath.multiply(t,new Point(0,1)),cmath.sqrt(cmath.add(cmath.opposite(cmath.multiply(t,t)),1)))),new Point(0,1)))},atan:function(t){return cmath.multiply(cmath.subtract(cmath.log(cmath.subtract(1,cmath.multiply(t,new Point(0,1)))),cmath.log(cmath.add(1,cmath.multiply(t,new Point(0,1))))),new Point(0,.5))}}});if(!(typeof $mate==="object"&&$mate!==null)){$mate={}}$mate.testing={};if(!(typeof featureLoaders==="object"&&featureLoaders!==null&&Array.isArray(featureLoaders))){featureLoaders=[]}$mate.testing.Test=function(){function Test(t){this.description=t!=null?t:"";this._children=[];this._fun=null;this._interpretedFunction=null;this.async=false;this.parent=null;this.unitResults=[];this.result=null}Test.prototype.set=function(fun){var funStr_834942610148628375;this._fun=fun;funStr_834942610148628375=null;(function(_this){return function(){var funStr,testArgName;funStr=fun.toString();testArgName="testArg_834942610148628375";(function(){return funStr=funStr.replace(/\([^\)]*\)/,"("+testArgName+")")})();(function(){var t,e,r,n,i,o,u,s,a,l,f;u=[];s=null;l=true;f=false;e=false;r=0;while(r<funStr.length){t=funStr[r];i=l;if(s===null){if("a"<=t&&t<="z"||"A"<=t&&t<="Z"||"0"<=t&&t<="9"||t==="_"||t==="$"||t===")"||t==="]"){l=false}else if(t===" "||t==="	"||t==="\n"||t==="\r"){}else{l=true}}o=f;if(s===null){if("a"<=t&&t<="z"||"A"<=t&&t<="Z"||"0"<=t&&t<="9"||t==="_"||t==="$"||t==="."){f=true}else{f=false}}n=e;if(s===null){if(t==="."){e=true}else if(t===" "||t==="	"||t==="\n"||t==="\r"){}else{e=false}}if(t==='"'&&s===null){s="double";r++}else if(t==="'"&&s===null){s="single";r++}else if(t==="/"&&s===null&&i){s="slash";r++}else if(t==='"'&&s==="double"||t==="'"&&s==="single"||t==="/"&&s==="slash"){s=null;r++}else if(t==="\\"&&s!==null){r+=2}else if(s===null&&!o&&!n&&("a"<=t&&t<="z")){a=funStr.substr(r,10);if(/^(finish|equal|unit)[^a-zA-Z0-9_$]/g.test(a)){u.push(r)}r++}else{r++}}return u.forEach(function(t,e){var r;r=t+(testArgName.length+1)*e;return funStr=funStr.substr(0,r)+testArgName+"."+funStr.substr(r)})})();(function(){return funStr=funStr.replace(RegExp(""+testArgName+"\\.unit\\s*\\(\\s*(\"(?:[^\"\\\\]|\\\\.)*\"|'(?:[^'\\\\]|\\\\.)*')(?:\\s*,\\s*(\"(?:[^\"\\\\]|\\\\.)*\"|'(?:[^'\\\\]|\\\\.)*'))?\\s*\\)","g"),function(match,p1,p2){var newStr,parsed,unitStr;unitStr=eval(p1);parsed=null;newStr=null;(function(){var t,e,r,n,i,o,u,s;o=null;i=0;e=0;t=0;for(n=u=0,s=unitStr.length;0<=s?u<s:u>s;n=0<=s?++u:--u){r=unitStr[n];if(r==='"'&&o===null){o="double"}else if(r==="'"&&o===null){o="single"}else if(r==='"'&&o==="double"||r==="'"&&o==="single"){o=null}else if(r==="("){i++}else if(r==="["){e++}else if(r==="{"){t++}else if(r===")"){i--}else if(r==="]"){e--}else if(r==="}"){t--}else if(o===null&&(i===e&&e===t&&t===0)){if(r==="="){parsed={type:"equal",str1:unitStr.substr(0,n).trim(),str2:unitStr.substr(n+1).trim()};return}}}})();(function(){if(parsed.type==="equal"){return newStr=""+testArgName+".equal("+parsed.str1+", "+parsed.str2+", "+(p2!=null?p2:p1)+")"}})();return newStr})})();funStr_834942610148628375=funStr;return _this.async=funStr.indexOf(""+testArgName+".finish")!==-1}})(this)();this._interpretedFunction=eval("("+funStr_834942610148628375+")");return this};Test.prototype.get=function(){return this._fun};Test.prototype.add=function(t,e){var r;if(typeof t==="object"){r=t}else{if(typeof t!=="string"){e=t;t=""}r=new $mate.testing.Test(t).set(e)}r.parent=this;this._children.push(r);return this};Test.prototype.getChildren=function(){return this._children.slice(0)};Test.prototype.getAncestors=function(){var t,e;e=this;t=[];while(e.parent!==null){t.push(e.parent);e=e.parent}return t};Test.prototype.run=function(t){var e,r,n,i;if(t==null){t=true}if(this._fun!=null){setTimeout(function(t){return function(){var e,r;e=function(){t._interpretedFunction(t);if(!t.async){return t.finish({type:true})}};if(typeof exports!=="undefined"&&exports!==null&&(typeof module!=="undefined"&&module!==null?module.exports:void 0)!=null){r=require("domain").create();r.on("error",function(e){return t.finish({type:false,errorMessage:"Error Name: "+e.name+"\nError Message: "+e.message+"\nError Stack: "+e.stack})});return r.run(e)}else{try{return e()}catch(e){return t.finish({type:false})}}}}(this),0)}this.getChildren().forEach(function(t){return function(t){return t.run(false)}}(this));if(t){e=[];if(this.get()!=null){e.push(this)}i=function(t){return function(t){return t.getChildren().forEach(function(t){if(t.get()!=null){e.push(t)}return i(t)})}}(this);i(this);console.log();n=function(t){return function(){var t,n,i,o;i=e.filter(function(t){return t.result!=null&&t.result.type===true});t=e.filter(function(t){return t.result!=null&&t.result.type===false});o=e.filter(function(t){return t.result==null});console.log(""+(new Date).toISOString()+" OK: "+i.length+", "+("Exception: "+t.length+", Pending: "+o.length));if(o.length===0){clearInterval(r);t.forEach(function(t){console.log("\n********** Exceptional Test **********");console.log("Test: "+t.description);console.log("Function: "+t.get().toString());if(t.result.errorMessage!=null){return console.log(t.result.errorMessage)}});n=0;e.forEach(function(t){return t.unitResults.filter(function(t){return t.type===false}).forEach(function(e){var r,i;n++;r=t.getAncestors();r.reverse();i=r.concat([t]).map(function(t){return t.description}).join(" --> ");console.log("\n********** Failed Unit **********");console.log("    Test: "+i);console.log("    Unit: "+e.description);console.log("Expected: "+e.expected);return console.log("  Actual: "+e.actual)})});console.log("\n"+(t.length===0&&n===0?"Completed. All tests are OK. All units succeeded.":"Completed. "+t.length+" exceptional tests. "+(""+n+" failed units."))+"\n");if(typeof process!=="undefined"&&process!==null){return process.exit()}}}}(this);r=setInterval(n,1e3);setTimeout(n,0)}return this};Test.prototype.finish=function(t){this.result=t!=null?t:{type:true};return this};Test.prototype.equal=function(t,e,r){var n,i;if(r==null){r=""}n=function(t){return function(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(e.every(function(e,r){return n(t[r],e)})){return true}else{return false}}else if(typeof t==="object"&&t!==null&&typeof e==="object"&&e!==null){if(Object.keys(e).every(function(r){return n(t[r],e[r])})){return true}else{return false}}else if(typeof t==="number"&&typeof e==="number"){if(t===0&&e===0&&1/t!==1/e){return false}else{return t===e}}else{return t===e}}}(this);i={type:n(t,e),description:r};if(i.type===false){i.actual=JSON.stringify(t);i.expected=JSON.stringify(e)}this.unitResults.push(i);return this};return Test}();featureLoaders.push(function(){return global.Test=$mate.testing.Test});featureLoaders.push(function(){Date.Timer=function(){t._endOfTime=new Date("9999-12-30T00:00:00Z");function t(t){this.targetTime=t!=null?t:Date.Timer._endOfTime;this._counterValue=0;this._internalTimer=null;this._running=false;this.allowsEqual=true;this.precision=30;this.onArrive=eventField()}t.prototype.run=function(){if(this._running){return}this._counterValue=0;this._internalTimer=setInterval(function(t){return function(){var e,r;r=new Date;if(t.allowsEqual?r>=t.targetTime:r>t.targetTime){t._counterValue++;e=t.targetTime;t.targetTime=Date.Timer._endOfTime;return t.onArrive.fire({idealTime:e,nowTime:r,index:t._counterValue-1})}}}(this),this.precision);this._running=true;return this};t.prototype.stop=function(){if(!this._running){return}clearInterval(this._internalTimer);this._running=false;return this};t.prototype.getRunning=function(){return this._running};t.prototype.resetCounter=function(){return this._counterValue=0};t.prototype.getCounterValue=function(){return this._counterValue};return t}();return Date.IntervalTimer=function(t){__extends(e,t);function e(t,r,n){this.interval=t!=null?t:1e3;this.startTime=r!=null?r:new Date;this.endTime=n;e.__super__.constructor.call(this);this._started=false;this.includesStart=true;this.includesEnd=false;this.onStart=eventField();this.onArrive.bind(function(t){return function(e){t.targetTime=e.idealTime.add(t.interval);if(!t._started){t._started=true;if(!t.includesStart){t.resetCounter();e.blocksListeners=true}t.onStart.fire()}if(t.endTime!=null&&(t.includesEnd?t.targetTime>t.endTime:t.targetTime>=t.endTime)){return t.stop()}}}(this))}e.prototype.run=function(){if(this.getRunning()){return}this.targetTime=this.startTime;return e.__super__.run.call(this)};return e}(Date.Timer)});if($mate.environmentType==="browser"){window.$mate=$mate}else if($mate.environmentType==="node"){module.exports=$mate}else{throw new Error}$mate.nodePackageInfo={name:"mate",version:"0.6.2",description:"Your JavaScript/CoffeeScript mate.",keywords:["test","unit","testing","event","coffeescript","timer","math","javascript","es6","js","coffee"],author:"Zhenzhen Zhan <zhanzhenzhen@hotmail.com>",homepage:"https://github.com/zhanzhenzhen/mate",licenses:[{type:"MIT",url:"https://github.com/zhanzhenzhen/mate/blob/master/LICENSE.txt"}],repository:{type:"git",url:"https://github.com/zhanzhenzhen/mate.git"},devDependencies:{"coffee-script":"1.7.1","uglify-js":"2.4.13"},main:"mate"}}).call(this);