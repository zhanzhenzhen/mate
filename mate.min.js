/* @preserve
Mate
https://github.com/zhanzhenzhen/mate
(c) 2013 Zhenzhen Zhan
Mate may be freely distributed under the MIT license.
 */
(function(){var featureLoaders,npmMate,__indexOf=[].indexOf||function(t){for(var e=0,r=this.length;e<r;e++){if(e in this&&this[e]===t)return e}return-1},__hasProp={}.hasOwnProperty,__extends=function(t,e){for(var r in e){if(__hasProp.call(e,r))t[r]=e[r]}function n(){this.constructor=t}n.prototype=e.prototype;t.prototype=new n;t.__super__=e.prototype;return t};featureLoaders=[];npmMate={};npmMate.testing={};npmMate.environmentType=typeof exports!=="undefined"&&exports!==null&&(typeof module!=="undefined"&&module!==null?module.exports:void 0)!=null?"node":typeof window!=="undefined"&&window!==null?"browser":void 0;npmMate.enableAllFeatures=function(){if(npmMate.environmentType==="browser"){window.global=window}global.npmMate=npmMate;return featureLoaders.forEach(function(t){return t()})};npmMate.testing.Test=function(){function Test(t){this.description=t!=null?t:"";this._children=[];this._fun=null;this._interpretedFunction=null;this._envFun=null;this.async=false;this.parent=null;this._resetContext()}Test.prototype._resetContext=function(){this.env={};this.unitResults=[];return this.result=null};Test.prototype.define=function(t){this._envFun=t;return this};Test.prototype.set=function(t){this._fun=t;return this};Test.prototype.get=function(){return this._fun};Test.prototype._interpret=function(){var funStr_834942610148628375;funStr_834942610148628375=null;(function(_this){return function(){var funStr,testArgName;funStr=_this._fun.toString();testArgName="testArg_834942610148628375";funStr=funStr.replace(/\([^\)]*\)/,"("+testArgName+")");npmMate.testing.parseFunction(funStr).forEach(function(t,e){var r,n;r=testArgName+".";n=t+r.length*e;return funStr=funStr.substr(0,n)+r+funStr.substr(n)});funStr=funStr.replace(RegExp(""+testArgName+"\\.unit\\s*\\(\\s*(\"(?:[^\"\\\\]|\\\\.)*\"|'(?:[^'\\\\]|\\\\.)*')(?:\\s*,\\s*(\"(?:[^\"\\\\]|\\\\.)*\"|'(?:[^'\\\\]|\\\\.)*'))?\\s*\\)","g"),function(match,p1,p2){var args,description,parsed,unitStr;if(p2===""){p2=void 0}unitStr=eval(p1).trim();description=p2!=null?p2:JSON.stringify(unitStr);parsed=npmMate.testing.parseUnitString(unitStr);args=parsed.components;args.push(description);return""+testArgName+"."+parsed.type+"("+args.join(", ")+")"});npmMate.testing.parseFunction(funStr,Object.keys(_this.env)).forEach(function(t,e){var r,n;r=testArgName+".env.";n=t+r.length*e;return funStr=funStr.substr(0,n)+r+funStr.substr(n)});funStr_834942610148628375=funStr;return _this.async=funStr.indexOf(""+testArgName+".finish")!==-1}})(this)();this._interpretedFunction=eval("("+funStr_834942610148628375+")");return this};Test.prototype.add=function(t,e){var r;if(typeof t==="object"){r=t}else{if(typeof t!=="string"){e=t;t=""}r=new npmMate.testing.Test(t).set(e)}r.parent=this;this._children.push(r);return this};Test.prototype.getChildren=function(){return this._children.slice(0)};Test.prototype.getAncestors=function(){var t,e;e=this;t=[];while(e.parent!==null){t.push(e.parent);e=e.parent}return t};Test.prototype.run=function(t){var e,r,n,i;if(t==null){t=true}this._resetContext();if(this.parent!=null){this.env=npmMate.testing.objectClone(this.parent.env)}if(typeof this._envFun==="function"){this._envFun(this.env)}if(this._fun!=null){this._interpret();setTimeout(function(t){return function(){var e,r;e=function(){t._interpretedFunction(t);if(!t.async){return t.finish({type:true})}};if(typeof exports!=="undefined"&&exports!==null&&(typeof module!=="undefined"&&module!==null?module.exports:void 0)!=null){r=require("domain").create();r.on("error",function(e){return t.finish({type:false,errorMessage:"Error Name: "+e.name+"\nError Message: "+e.message+"\nError Stack: "+e.stack})});return r.run(e)}else{try{return e()}catch(e){return t.finish({type:false})}}}}(this),0)}this.getChildren().forEach(function(t){return function(t){return t.run(false)}}(this));if(t){e=[];if(this.get()!=null){e.push(this)}i=function(t){return function(t){return t.getChildren().forEach(function(t){if(t.get()!=null){e.push(t)}return i(t)})}}(this);i(this);console.log();n=function(t){return function(){var t,n,i,o,u,s;u=e.filter(function(t){return t.result!=null&&t.result.type===true});t=e.filter(function(t){return t.result!=null&&t.result.type===false});s=e.filter(function(t){return t.result==null});console.log(""+(new Date).toISOString()+" OK: "+u.length+", "+("Exception: "+t.length+", Pending: "+s.length));if(s.length===0){clearInterval(r);t.forEach(function(t){console.log("\n********** Exceptional Test **********");console.log("Test: "+t.description);console.log("Function: "+t.get().toString());if(t.result.errorMessage!=null){return console.log(t.result.errorMessage)}});n=0;o="";e.forEach(function(t){return t.unitResults.forEach(function(e){var r,i;o+=" "+e.type.toString();if(e.type===false){n++;r=t.getAncestors();r.reverse();i=r.concat([t]).map(function(t){return t.description}).join(" --> ");console.log("\n********** Failed Unit **********");console.log("    Test: "+i);console.log("    Unit: "+e.description);console.log("Expected: "+e.expected);return console.log("  Actual: "+e.actual)}})});o=o.trim();i=npmMate.testing.sha256(o).substr(0,5);console.log("\n"+(t.length===0&&n===0?"All tests are OK. All units succeeded.":""+t.length+" Exceptional Tests, "+(""+n+" Failed Units, ")+("Mark: "+i))+"\n");if(typeof process!=="undefined"&&process!==null){return process.exit()}}}}(this);r=setInterval(n,1e3);setTimeout(n,0)}return this};Test.prototype.finish=function(t){this.result=t!=null?t:{type:true};return this};Test.prototype.equal=function(t,e,r){var n,i,o;if(r==null){r=""}o=[];n=function(t){return function(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(e.every(function(e,r){if(__indexOf.call(o,e)>=0){return npmMate.testing.objectIs(t[r],e)}else{if(typeof e==="object"&&e!==null){o.push(e)}return n(t[r],e)}})){return true}else{return false}}else if(typeof t==="object"&&t!==null&&typeof e==="object"&&e!==null){if(Object.keys(e).every(function(r){var i;if(i=e[r],__indexOf.call(o,i)>=0){return npmMate.testing.objectIs(t[r],e[r])}else{if(typeof e[r]==="object"&&e[r]!==null){o.push(e[r])}return n(t[r],e[r])}})){return true}else{return false}}else{return npmMate.testing.objectIs(t,e)}}}(this);i={type:n(t,e),description:r};if(i.type===false){i.actual=npmMate.testing.valueToMessage(t);i.expected="= "+npmMate.testing.valueToMessage(e)}this.unitResults.push(i);return this};Test.prototype.notEqual=function(t,e,r){var n,i,o;if(r==null){r=""}o=[];n=function(t){return function(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(e.some(function(e,r){if(__indexOf.call(o,e)>=0){return!npmMate.testing.objectIs(t[r],e)}else{if(typeof e==="object"&&e!==null){o.push(e)}return n(t[r],e)}})){return true}else{return false}}else if(typeof t==="object"&&t!==null&&typeof e==="object"&&e!==null){if(Object.keys(e).some(function(r){var i;if(i=e[r],__indexOf.call(o,i)>=0){return!npmMate.testing.objectIs(t[r],e[r])}else{if(typeof e[r]==="object"&&e[r]!==null){o.push(e[r])}return n(t[r],e[r])}})){return true}else{return false}}else{return!npmMate.testing.objectIs(t,e)}}}(this);i={type:n(t,e),description:r};if(i.type===false){i.actual=npmMate.testing.valueToMessage(t);i.expected="â‰  "+npmMate.testing.valueToMessage(e)}this.unitResults.push(i);return this};Test.prototype.is=function(t,e,r){var n;if(r==null){r=""}n={type:npmMate.testing.objectIs(t,e),description:r};if(n.type===false){n.actual=npmMate.testing.valueToMessage(t);n.expected="is "+npmMate.testing.valueToMessage(e)}this.unitResults.push(n);return this};Test.prototype.isnt=function(t,e,r){var n;if(r==null){r=""}n={type:!npmMate.testing.objectIs(t,e),description:r};if(n.type===false){n.actual=npmMate.testing.valueToMessage(t);n.expected="isn't "+npmMate.testing.valueToMessage(e)}this.unitResults.push(n);return this};Test.prototype.throws=function(t,e,r){var n,i,o,u;if(r==null){r=""}o=false;u=function(){try{t();o=true;return false}catch(t){n=t;if(e==null){return true}else if(e instanceof RegExp){if(e.test(n.message)){return true}else{return false}}else{if(n instanceof e){return true}else{return false}}}}();i={type:u,description:r};if(i.type===false){i.actual=o?"no exception":"another exception";i.expected=o?"exception":"an exception"}this.unitResults.push(i);return this};Test.prototype.doesNotThrow=function(t,e){var r,n;if(e==null){e=""}n=function(){try{t();return true}catch(t){return false}}();r={type:n,description:e};if(r.type===false){r.actual="exception";r.expected="no exception"}this.unitResults.push(r);return this};return Test}();npmMate.testing.objectIs=function(t,e){if(typeof t==="number"&&typeof e==="number"){if(t===0&&e===0){return 1/t===1/e}else if(isNaN(t)&&isNaN(e)){return true}else{return t===e}}else{return t===e}};npmMate.testing.objectClone=function(t){var e,r,n,i,o;r={};o=Object.keys(t);for(n=0,i=o.length;n<i;n++){e=o[n];r[e]=t[e]}return r};npmMate.testing.valueToMessage=function(t){var e,r;e=function(t,r){if(t===void 0){return"undefined"}else if(t===null){return"null"}else if(Array.isArray(t)){if(r>0){return"["+t.map(function(t){return e(t,r-1)}).join(",")+"]"}else{return"[Array]"}}else if(typeof t==="function"){return"[Function]"}else if(typeof t==="object"){if(r>0){return"{"+Object.keys(t).map(function(n){return""+JSON.stringify(n)+":"+e(t[n],r-1)}).join(",")+"}"}else{return"[Object]"}}else if(typeof t==="string"){return JSON.stringify(t.toString())}else if(typeof t==="number"){if(npmMate.testing.objectIs(t,-0)){return"-0"}else{return t.toString()}}else{return t.toString()}};r=e(t,3);if(r.length>1e3){r=e(t,2)}if(r.length>1e3){r=e(t,1)}if(r.length>1e3){r=e(t,0)}return r};featureLoaders.push(function(){return global.Test=npmMate.testing.Test});npmMate.testing.parseFunction=function(t,e){var r,n,i,o,u,s,a,l,p,f,c,h,y;o=e!=null?e:["finish","unit"];if(o.length===0){return[]}f=new RegExp("^("+o.join("|")+")[^a-zA-Z0-9_$]","g");l=[];p=null;h=true;y=false;n=false;i=0;while(i<t.length){r=t[i];s=h;if(p===null){if("a"<=r&&r<="z"||"A"<=r&&r<="Z"||"0"<=r&&r<="9"||r==="_"||r==="$"||r===")"||r==="]"){h=false}else if(r===" "||r==="	"||r==="\n"||r==="\r"){}else{h=true}}a=y;if(p===null){if("a"<=r&&r<="z"||"A"<=r&&r<="Z"||"0"<=r&&r<="9"||r==="_"||r==="$"||r==="."){y=true}else{y=false}}u=n;if(p===null){if(r==="."){n=true}else if(r===" "||r==="	"||r==="\n"||r==="\r"){}else{n=false}}if(r==='"'&&p===null){p="double";i++}else if(r==="'"&&p===null){p="single";i++}else if(r==="/"&&p===null&&s){p="slash";i++}else if(r==='"'&&p==="double"||r==="'"&&p==="single"||r==="/"&&p==="slash"){p=null;i++}else if(r==="\\"&&p!==null){i+=2}else if(p===null&&!a&&!u&&("a"<=r&&r<="z")){c=t.substr(i,31);if(c.search(f)!==-1){l.push(i)}i++}else{i++}}return l};npmMate.testing.parseUnitString=function(t){var e,r,n,i,o,u,s,a,l,p,f,c,h;p=null;f=null;l=0;r=0;e=0;h=true;i=false;o=0;while(o<t.length){n=t[o];a=h;if(f===null){if("a"<=n&&n<="z"||"A"<=n&&n<="Z"||"0"<=n&&n<="9"||n==="_"||n==="$"||n===")"||n==="]"){h=false}else if(n===" "||n==="	"||n==="\n"||n==="\r"){}else{h=true}}s=i;if(f===null){if(n==="."){i=true}else if(n===" "||n==="	"||n==="\n"||n==="\r"){}else{i=false}}if(n==='"'&&f===null){f="double";o++}else if(n==="'"&&f===null){f="single";o++}else if(n==="/"&&f===null&&a){f="slash";o++}else if(n==='"'&&f==="double"||n==="'"&&f==="single"||n==="/"&&f==="slash"){f=null;o++}else if(n==="\\"&&f!==null){o+=2}else if(n==="("){l++;o++}else if(n==="["){r++;o++}else if(n==="{"){e++;o++}else if(n===")"){l--;o++}else if(n==="]"){r--;o++}else if(n==="}"){e--;o++}else if(f===null&&!s&&(l===r&&r===e&&e===0)){c=t.substr(o);if((u=c.match(/^=([^]+)$/))!=null){p={type:"equal",components:[t.substr(0,o),u[1]]};break}else if((u=c.match(/^<>([^]+)$/))!=null){p={type:"notEqual",components:[t.substr(0,o),u[1]]};break}else if((u=c.match(/^\sis\s([^]+)$/))!=null){p={type:"is",components:[t.substr(0,o),u[1]]};break}else if((u=c.match(/^\sisnt\s([^]+)$/))!=null){p={type:"isnt",components:[t.substr(0,o),u[1]]};break}else if((u=c.match(/^\sthrows(?:\s([^]+))?$/))!=null){p={type:"throws",components:[t.substr(0,o),u[1]!=null?u[1]:"undefined"]};break}o++}else{o++}}if(p==null){p={type:"doesNotThrow",components:[t]}}p.components=p.components.map(function(t){return t.trim()});return p};npmMate.testing.sha256=function(t){var e,r,n,i,o,u,s,a,l,p,f,c,h,y,m,g,d,_,A,v,b,x,M,w,S,O,T,N,P,I,E,D,j,L,F,q,C,U,k,R;if(t.length>Math.round(Math.pow(2,31)-1)){throw new Error}j=function(t){var e;return function(){var r,n;n=[];for(e=r=7;r>=0;e=--r){n.push(((t>>>e*4)%16).toString(16))}return n}().join("")};m=function(){var t,e,r,n;e=0;for(r=0,n=arguments.length;r<n;r++){t=arguments[r];e=(e+t)%4294967296}return e};s=function(t,e){return t>>>e|t<<32-e};a=function(t,e){return t>>>e};e=function(t,e,r){return t&e^~t&r};o=function(t,e,r){return t&e^t&r^e&r};l=function(t){return s(t,2)^s(t,13)^s(t,22)};p=function(t){return s(t,6)^s(t,11)^s(t,25)};I=function(t){return s(t,7)^s(t,18)^a(t,3)};E=function(t){return s(t,17)^s(t,19)^a(t,10)};n=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];r=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];d=t.split("").map(function(t){return t.charCodeAt(0)});T=t.length*8;O=448-T-1;while(O<0){O+=512}P=T+1+O+64;d.push(128);for(w=L=0,R=Math.round((O-7)/8);0<=R?L<R:L>R;w=0<=R?++L:--L){d.push(0)}d.push(0);d.push(0);d.push(0);d.push(0);d.push(T>>>24);d.push((T>>>16)%256);d.push((T>>>8)%256);d.push(T%256);u=Math.round(P/512);i=new Array(u);for(w=F=0;0<=u?F<u:F>u;w=0<=u?++F:--F){i[w]=new Array(16);for(S=q=0;q<16;S=++q){N=w*64+S*4;i[w][S]=d[N]<<24|d[N+1]<<16|d[N+2]<<8|d[N+3]}}h=new Array(64);for(w=C=0;0<=u?C<u:C>u;w=0<=u?++C:--C){for(D=U=0;U<64;D=++U){h[D]=D<16?i[w][D]:m(E(h[D-2]),h[D-7],I(h[D-15]),h[D-16])}y=r[0];g=r[1];_=r[2];A=r[3];v=r[4];b=r[5];x=r[6];M=r[7];for(D=k=0;k<64;D=++k){f=m(M,p(v),e(v,b,x),n[D],h[D]);c=m(l(y),o(y,g,_));M=x;x=b;b=v;v=m(A,f);A=_;_=g;g=y;y=m(f,c)}r[0]=m(y,r[0]);r[1]=m(g,r[1]);r[2]=m(_,r[2]);r[3]=m(A,r[3]);r[4]=m(v,r[4]);r[5]=m(b,r[5]);r[6]=m(x,r[6]);r[7]=m(M,r[7])}return r.map(function(t){return j(t)}).join("")};featureLoaders.push(function(){var t;t=function(){function t(t,e,r){this._value=t;this._chain=(e!=null?e:[]).slice(0);if(r!=null){this._chain.push(r)}Object.getter(this,"length",function(t){return function(){return t.force().length}}(this))}t.prototype.force=function(){var t,e,r,n,i;e=this._value;i=this._chain;for(r=0,n=i.length;r<n;r++){t=i[r];e=t.fun.apply(e,t.args)}return e};t.prototype.map=function(){return this._pushChain(Array.prototype.map,arguments)};t.prototype.filter=function(){return this._pushChain(Array.prototype.filter,arguments)};t.prototype.concat=function(){return this._pushChain(Array.prototype.concat,arguments)};t.prototype.portion=function(){return this._pushChain(Array.prototype.portion,arguments)};t.prototype.funSort=function(){return this._pushChain(Array.prototype.funSort,arguments)};t.prototype.funSortDescending=function(){return this._pushChain(Array.prototype.funSortDescending,arguments)};t.prototype.funReverse=function(){return this._pushChain(Array.prototype.funReverse,arguments)};t.prototype.except=function(){return this._pushChain(Array.prototype.except,arguments)};t.prototype.group=function(){return this._pushChain(Array.prototype.group,arguments)};t.prototype.flatten=function(){return this._pushChain(Array.prototype.flatten,arguments)};t.prototype.random=function(){return this._pushChain(Array.prototype.random,arguments)};t.prototype.some=function(){return this._unwrapAndDo(Array.prototype.some,arguments)};t.prototype.every=function(){return this._unwrapAndDo(Array.prototype.every,arguments)};t.prototype.isEmpty=function(){return this._unwrapAndDo(Array.prototype.isEmpty,arguments)};t.prototype.at=function(){return this._unwrapAndDo(Array.prototype.at,arguments)};t.prototype.atOrNull=function(){return this._unwrapAndDo(Array.prototype.atOrNull,arguments)};t.prototype.contains=function(){return this._unwrapAndDo(Array.prototype.contains,arguments)};t.prototype.first=function(){return this._unwrapAndDo(Array.prototype.first,arguments)};t.prototype.firstOrNull=function(){return this._unwrapAndDo(Array.prototype.firstOrNull,arguments)};t.prototype.last=function(){return this._unwrapAndDo(Array.prototype.last,arguments)};t.prototype.lastOrNull=function(){return this._unwrapAndDo(Array.prototype.lastOrNull,arguments)};t.prototype.single=function(){return this._unwrapAndDo(Array.prototype.single,arguments)};t.prototype.singleOrNull=function(){return this._unwrapAndDo(Array.prototype.singleOrNull,arguments)};t.prototype.withMax=function(){return this._unwrapAndDo(Array.prototype.withMax,arguments)};t.prototype.withMin=function(){return this._unwrapAndDo(Array.prototype.withMin,arguments)};t.prototype.max=function(){return this._unwrapAndDo(Array.prototype.max,arguments)};t.prototype.min=function(){return this._unwrapAndDo(Array.prototype.min,arguments)};t.prototype.sum=function(){return this._unwrapAndDo(Array.prototype.sum,arguments)};t.prototype.average=function(){return this._unwrapAndDo(Array.prototype.average,arguments)};t.prototype.median=function(){return this._unwrapAndDo(Array.prototype.median,arguments)};t.prototype.product=function(){return this._unwrapAndDo(Array.prototype.product,arguments)};t.prototype.randomOne=function(){return this._unwrapAndDo(Array.prototype.randomOne,arguments)};t.prototype._pushChain=function(e,r){return new t(this._value,this._chain,{fun:e,args:r})};t.prototype._unwrapAndDo=function(t,e){return t.apply(this.force(),e)};return t}();Array._elementOrUseSelector=function(t,e){if(e!=null){return e(t)}else{return t}};Array.prototype._numberToIndex=function(t){if(0<t&&t<1){return t=Math.round(t*(this.length-1))}else{return t}};Array.prototype._numberToLength=function(t){if(0<t&&t<1){return t=Math.round(t*this.length)}else{return t}};Array.prototype.copy=function(){return this.slice(0)};Array.prototype.isEmpty=function(){return this.length===0};Array.prototype.lazy=function(){return new t(this)};Array.prototype.portion=function(t,e,r){if(Number.isFraction(t)||Number.isFraction(e)||Number.isFraction(r)){if(t===0){t=0+Number.EPSILON}if(t===1){t=1-Number.EPSILON}if(e===0){e=0+Number.EPSILON}if(e===1){e=1-Number.EPSILON}if(r===0){r=0+Number.EPSILON}if(r===1){r=1-Number.EPSILON}}t=this._numberToIndex(t);e=this._numberToLength(e);r=this._numberToIndex(r);return this.slice(t,e!=null?t+e:r+1)};Array.prototype.at=function(t){t=this._numberToIndex(t);assert(0<=t&&t<this.length);return this[t]};Array.prototype.atOrNull=function(t){try{return this.at(t)}catch(t){return null}};Array.prototype.contains=function(t){return __indexOf.call(this,t)>=0};Array.prototype.first=function(t){var e;e=t!=null?this.filter(t):this;return e.at(0)};Array.prototype.firstOrNull=function(t){try{return this.first(t)}catch(t){return null}};Array.prototype.last=function(t){var e;e=t!=null?this.filter(t):this;return e.at(e.length-1)};Array.prototype.lastOrNull=function(t){try{return this.last(t)}catch(t){return null}};Array.prototype.single=function(t){var e;e=t!=null?this.filter(t):this;assert(e.length===1);return e.at(0)};Array.prototype.singleOrNull=function(t){try{return this.single(t)}catch(t){return null}};Array.prototype.withMax=function(t){return this.reduce(function(e){return function(e,r,n){if(Array._elementOrUseSelector(e,t)>Array._elementOrUseSelector(r,t)){return e}else{return r}}}(this))};Array.prototype.withMin=function(t){return this.reduce(function(e){return function(e,r,n){if(Array._elementOrUseSelector(e,t)<Array._elementOrUseSelector(r,t)){return e}else{return r}}}(this))};Array.prototype.max=function(t){return Array._elementOrUseSelector(this.withMax(t),t)};Array.prototype.min=function(t){return Array._elementOrUseSelector(this.withMin(t),t)};Array.prototype.sum=function(t){if(this.length===1){return Array._elementOrUseSelector(this.first(),t)}else{return this.reduce(function(e){return function(e,r,n){return(n===1?Array._elementOrUseSelector(e,t):e)+Array._elementOrUseSelector(r,t)}}(this))}};Array.prototype.average=function(t){return this.sum(t)/this.length};Array.prototype.median=function(t){var e,r,n,i,o;o=this.funSort(t);e=o.at(.5-Number.EPSILON);r=o.at(.5+Number.EPSILON);n=Array._elementOrUseSelector(e,t);i=Array._elementOrUseSelector(r,t);return(n+i)/2};Array.prototype.product=function(t){if(this.length===1){return Array._elementOrUseSelector(this.first(),t)}else{return this.reduce(function(e){return function(e,r,n){return(n===1?Array._elementOrUseSelector(e,t):e)*Array._elementOrUseSelector(r,t)}}(this))}};Array.prototype.group=function(t,e){var r,n,i,o,u,s,a,l;if(this.isEmpty()){return[]}s=this.funSort(t);u=[];r=Array._elementOrUseSelector(s.first(),t);n=[];for(a=0,l=s.length;a<l;a++){o=s[a];i=Array._elementOrUseSelector(o,t);if(i!==r){u.push([r,Array._elementOrUseSelector(n,e)]);r=i;n=[]}n.push(o)}u.push([r,Array._elementOrUseSelector(n,e)]);return u};Array.prototype._sort=function(t,e){return this.copy().sort(function(r){return function(r,n){var i,o;i=Array._elementOrUseSelector(r,t);o=Array._elementOrUseSelector(n,t);if(i<o){if(e){return 1}else{return-1}}else if(i>o){if(e){return-1}else{return 1}}else{return 0}}}(this))};Array.prototype.funSort=function(t){return this._sort(t,false)};Array.prototype.funSortDescending=function(t){return this._sort(t,true)};Array.prototype.funReverse=function(){return this.copy().reverse()};Array.prototype.except=function(t){return this.filter(function(e){return __indexOf.call(t,e)<0})};Array.prototype.flatten=function(t){var e,r,n,i,o,u,s,a;if(t<=0){return fail()}else{i=[];e=false;for(o=0,s=this.length;o<s;o++){r=this[o];if(Array.isArray(r)){e=true;for(u=0,a=r.length;u<a;u++){n=r[u];i.push(n)}}else{i.push(r)}}if(e){if(t!=null){if(t===1){return i}else{return i.flatten(t-1)}}else{return i.flatten()}}else{return i}}};Array.prototype.randomOne=function(){return this[Math.randomInt(this.length)]};Array.prototype.random=function(t){return this.copy().takeRandom(t)};Array.prototype.takeRandomOne=function(){var t,e;t=Math.randomInt(this.length);e=this[t];this.removeAt(t);return e};Array.prototype.takeRandom=function(t){if(t==null){t=this.length}t=this._numberToLength(t);return repeat(t,function(t){return function(){return t.takeRandomOne()}}(this))};Array.prototype.removeAt=function(t){this.splice(t,1);return this};Array.prototype.remove=function(t){var e;e=this.indexOf(t);assert(e>-1);return this.removeAt(e)};Array.prototype.removeAll=function(t){var e;while(true){e=this.indexOf(t);if(e===-1){break}this.removeAt(e)}return this};Array.prototype.removeMatch=function(t){var e;e=this.findIndex(t);assert(e>-1);return this.removeAt(e)};return Array.prototype.removeAllMatch=function(t){var e;while(true){e=this.findIndex(t);if(e===-1){break}this.removeAt(e)}return this}});featureLoaders.push(function(){if(Number.EPSILON===void 0){Number.EPSILON=2.220446049250313e-16}if(Number.isInteger===void 0){Number.isInteger=function(t){return typeof t==="number"&&isFinite(t)&&t>-9007199254740992&&t<9007199254740992&&Math.floor(t)===t}}if(String.prototype.startsWith===void 0){String.prototype.startsWith=function(t){return this.indexOf(t)===0}}if(String.prototype.endsWith===void 0){String.prototype.endsWith=function(t){return this.lastIndexOf(t)===this.length-t.length}}if(String.prototype.contains===void 0){String.prototype.contains=function(t){return this.indexOf(t)!==-1}}if(Object.is===void 0){Object.is=npmMate.testing.objectIs}if(Array.from===void 0){Array.from=function(t){var e,r,n,i;i=[];for(r=0,n=t.length;r<n;r++){e=t[r];i.push(e)}return i}}if(Array.prototype.find===void 0){Array.prototype.find=function(t){var e;assert(typeof t==="function");e=this.filter(t);if(!e.isEmpty()){return e.at(0)}else{return void 0}}}if(Array.prototype.findIndex===void 0){Array.prototype.findIndex=function(t){var e;e=this.find(t);if(e===void 0){return-1}else{return this.indexOf(e)}}}if(Math.sign===void 0){Math.sign=function(t){if(typeof t==="number"){if(t===0){return 0}else if(t>0){return 1}else if(t<0){return-1}else{return NaN}}else{return NaN}}}if(global.setImmediate===void 0){global.setImmediate=function(t,e){return setTimeout(t,0,e)}}if(global.clearImmediate===void 0){return global.clearImmediate=clearTimeout}});featureLoaders.push(function(){global.compose=function(t){if(arguments.length>1){t=Array.from(arguments)}return function(){var e,r,n,i;e=arguments;for(n=0,i=t.length;n<i;n++){r=t[n];e=[r.apply(this,e)]}return e[0]}};global.fail=function(t){throw new Error(t)};global.assert=function(t,e){if(!t){return fail(e)}};global.repeat=function(t,e){var r,n,i,o;if(typeof t==="number"){i=[t,e],e=i[0],t=i[1]}o=[];for(r=n=0;0<=e?n<e:n>e;r=0<=e?++n:--n){o.push(t())}return o};global.spread=function(t,e){var r,n,i;i=[];for(r=n=0;0<=e?n<e:n>e;r=0<=e?++n:--n){i.push(t)}return i};Object.getter=function(t,e,r){return Object.defineProperty(t,e,{get:r,configurable:true})};Object.setter=function(t,e,r){return Object.defineProperty(t,e,{set:r,configurable:true})};Object.clone=function(t){var e,r,n,i,o;r={};o=Object.keys(t);for(n=0,i=o.length;n<i;n++){e=o[n];r[e]=t[e]}return r};JSON.clone=function(t){return JSON.parse(JSON.stringify(t))};String.prototype.matches=function(t){var e,r,n;e=new RegExp(t.source,"g");n=[];while(true){r=e.exec(this);if(r!=null){n.push(r)}else{break}}return n};String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.substr(1)};Date.prototype.add=function(t){return new Date(this- -t)};Date.prototype.subtract=function(t){if(typeof t==="number"){return new Date(this-t)}else{return this-t}};Date.prototype.equals=function(t){return t<=this&&this<=t};console.logt=function(){return console.log.apply(console,[(new Date).toISOString()].concat(Array.from(arguments)))};global.eventField=function(){var t;t=function(e,r){if(typeof e==="function"){r=e;e="bind"}assert(typeof e==="string");t[e](r);return this};t._listeners=[];t.bind=function(e){if(__indexOf.call(t._listeners,e)<0){t._listeners.push(e)}return t};t.unbind=function(e){t._listeners.removeAll(e);return t};t.fire=function(e){var r,n,i,o;o=t._listeners;for(n=0,i=o.length;n<i;n++){r=o[n];if(e!=null?e.blocksListeners:void 0){break}r(e)}return void 0};return t};return global.EventedObject=function(){function t(){this._eventList={}}t.prototype.on=function(t,e){var r;if((r=this._eventList)[t]==null){r[t]=[]}if(__indexOf.call(this._eventList[t],e)<0){this._eventList[t].push(e)}return this};t.prototype.off=function(t,e){this._eventList[t].removeAll(e);return this};t.prototype.fire=function(t,e){var r,n,i,o,u;if((n=this._eventList)[t]==null){n[t]=[]}u=this._eventList[t];for(i=0,o=u.length;i<o;i++){r=u[i];r(e)}return void 0};t.prototype.listeners=function(t){return this._eventList[t]};return t}()});featureLoaders.push(function(){Math.nearlyEquals=function(t,e){var r,n;r=1+1/65536;return 1/r<(n=t/e)&&n<r};Math.nearlyGreaterThan=function(t,e){return t>e||Math.nearlyEquals(t,e)};Math.nearlyLessThan=function(t,e){return t<e||Math.nearlyEquals(t,e)};Math.radiansToDegrees=function(t){return t/Math.PI*180};Math.degreesToRadians=function(t){return t/180*Math.PI};Math.principalRadians=function(t){var e;e=t%(2*Math.PI);if(e<=-Math.PI){return e+2*Math.PI}else if(e>Math.PI){return e-2*Math.PI}else{return e}};Math.principalDegrees=function(t){var e;e=t%360;if(e<=-180){return e+360}else if(e>180){return e-360}else{return e}};Math.randomNumber=function(t,e){if(t<e){return t+Math.random()*(e-t)}else{return fail()}};Math.randomInt=function(t,e){var r,n;n=e===void 0?0:t;r=e===void 0?t:e;return Math.floor(Math.randomNumber(n,r))};Number.isFraction=function(t){return typeof t==="number"&&isFinite(t)&&Math.floor(t)!==t};Number.parseFloatExt=function(t){return parseFloat(t)*(t.endsWith("%")?.01:1)};Number.prototype.nearlyEquals=function(t){return Math.nearlyEquals(this,t)};Number.prototype.nearlyGreaterThan=function(t){return Math.nearlyGreaterThan(this,t)};Number.prototype.nearlyLessThan=function(t){return Math.nearlyLessThan(this,t)};global.Point=function(){function t(t,e){this.x=t;this.y=e}t.from=function(e){if(typeof e==="number"){return new t(e,0)}else if(e instanceof t){return e.clone()}else if(typeof e==="string"){return t.fromString(e)}else if(Array.isArray(e)){return t.fromArray(e)}else{return fail()}};t.fromArray=function(e){return new t(e[0],e[1])};t.fromString=function(e){var r,n,i,o,u,s,a;r=e.replace(/[\x20()]/g,"");o=r.match(/^([^,]*),(.*)$/);if(o!=null){return new t(Number.parseFloatExt(o[1]),Number.parseFloatExt(o[2]))}else{n=r.match(/^([+-]?[0-9]*\.?[0-9]*(?:[Ee][+-]?[0-9]+)?(?![i0-9Ee.]))?(?:([+-]?[0-9]*\.?[0-9]*(?:[Ee][+-]?[0-9]+)?)i)?$/);if(n!=null){u=(s=n[1])!=null?s:"0";i=(a=n[2])!=null?a:"0";if(u===""){u="1"}if(i===""){i="1"}if(u==="+"){u="1"}if(i==="+"){i="1"}if(u==="-"){u="-1"}if(i==="-"){i="-1"}return new t(parseFloat(u),parseFloat(i))}else{return fail()}}};t.fromPolar=function(e,r){return new t(e*Math.cos(r),e*Math.sin(r))};t.fromPolarInDegrees=function(e,r){switch(Math.principalDegrees(r)){case 0:return new t(e,0);case 90:return new t(0,e);case-90:return new t(0,-e);case 180:return new t(-e,0);default:return t.fromPolar(e,Math.degreesToRadians(r))}};t.prototype.real=function(){return this.x};t.prototype.imaginary=function(){return this.y};t.prototype.toString=function(){return"("+this.x+","+this.y+")"};t.prototype.toComplexString=function(){var t;t=this.y>=0?"+":"-";return""+this.x+t+Math.abs(this.y)+"i"};t.prototype.clone=function(){return new t(this.x,this.y)};t.prototype.equals=function(t){return cmath.equals(this,t)};t.prototype.nearlyEquals=function(t){return cmath.nearlyEquals(this,t)};t.prototype.opposite=function(){return cmath.opposite(this)};t.prototype.reciprocal=function(){return cmath.reciprocal(this)};t.prototype.conjugate=function(){return cmath.conjugate(this)};t.prototype.abs=function(){return cmath.abs(this)};t.prototype.add=function(t){return cmath.add(this,t)};t.prototype.subtract=function(t){return cmath.subtract(this,t)};t.prototype.multiply=function(t){return cmath.multiply(this,t)};t.prototype.divide=function(t){return cmath.divide(this,t)};t.prototype.distance=function(t){return cmath.distance(this,t)};t.prototype.dotProduct=function(e){e=t.from(e);return this.x*e.x+this.y*e.y};t.prototype.crossProduct=function(e){e=t.from(e);return this.x*e.y-this.y*e.x};t.prototype.isOppositeTo=function(t){return this.opposite().equals(t)};t.prototype.phase=function(){return cmath.phase(this)};t.prototype.phaseTo=function(e){e=t.from(e);return Math.principalRadians(e.phase()-this.phase())};t.prototype.phaseInDegrees=function(){return cmath.phaseInDegrees(this)};t.prototype.phaseInDegreesTo=function(e){e=t.from(e);return Math.principalDegrees(e.phaseInDegrees()-this.phaseInDegrees())};t.prototype.scale=function(e){e=t.from(e);return new t(this.x*e.x,this.y*e.y)};t.prototype.rotate=function(e){return this.multiply(t.fromPolar(1,e))};t.prototype.rotateDegrees=function(e){return this.multiply(t.fromPolarInDegrees(1,e))};return t}();return global.cmath={equals:function(t,e){t=Point.from(t);e=Point.from(e);return t.x===e.x&&t.y===e.y},nearlyEquals:function(t,e){t=Point.from(t);e=Point.from(e);return t.x.nearlyEquals(e.x)&&t.y.nearlyEquals(e.y)},opposite:function(t){t=Point.from(t);return new Point(-t.x,-t.y)},reciprocal:function(t){var e;t=Point.from(t);e=t.x*t.x+t.y*t.y;return new Point(t.x/e,-t.y/e)},conjugate:function(t){t=Point.from(t);return new Point(t.x,-t.y)},abs:function(t){t=Point.from(t);if(t.x===0){return Math.abs(t.y)}else if(t.y===0){return Math.abs(t.x)
}else{return Math.sqrt(t.x*t.x+t.y*t.y)}},phase:function(t){t=Point.from(t);return Math.atan2(t.y,t.x)},phaseInDegrees:function(t){var e;t=Point.from(t);if(t.x===0&&t.y===0){return 0}else if(t.x===0&&t.y>0){return 90}else if(t.x===0&&t.y<0){return-90}else if(t.x>0&&t.y===0){return 0}else if(t.x<0&&t.y===0){return 180}else{e=Math.radiansToDegrees(cmath.phase(t));if(e<=-180){return 180}else{return e}}},add:function(t,e){t=Point.from(t);e=Point.from(e);return new Point(t.x+e.x,t.y+e.y)},subtract:function(t,e){return cmath.add(t,cmath.opposite(e))},multiply:function(t,e){t=Point.from(t);e=Point.from(e);return new Point(t.x*e.x-t.y*e.y,t.x*e.y+t.y*e.x)},divide:function(t,e){return cmath.multiply(t,cmath.reciprocal(e))},distance:function(t,e){return cmath.abs(cmath.subtract(t,e))},exp:function(t){t=Point.from(t);return Point.fromPolar(Math.exp(t.x),t.y)},log:function(t){return new Point(Math.log(cmath.abs(t)),cmath.phase(t))},pow:function(t,e){return cmath.exp(cmath.multiply(cmath.log(t),e))},sqrt:function(t){var e;t=Point.from(t);e=cmath.abs(t);return new Point(Math.sqrt((e+t.x)/2),Math.sign(t.y)*Math.sqrt((e-t.x)/2))},cos:function(t){return cmath.divide(cmath.add(cmath.exp(cmath.multiply(t,new Point(0,1))),cmath.exp(cmath.multiply(cmath.opposite(t),new Point(0,1)))),2)},sin:function(t){return cmath.divide(cmath.subtract(cmath.exp(cmath.multiply(t,new Point(0,1))),cmath.exp(cmath.multiply(cmath.opposite(t),new Point(0,1)))),new Point(0,2))},tan:function(t){return cmath.divide(cmath.sin(t),cmath.cos(t))},acos:function(t){return cmath.opposite(cmath.multiply(cmath.log(cmath.add(t,cmath.multiply(cmath.sqrt(cmath.add(cmath.opposite(cmath.multiply(t,t)),1)),new Point(0,1)))),new Point(0,1)))},asin:function(t){return cmath.opposite(cmath.multiply(cmath.log(cmath.add(cmath.multiply(t,new Point(0,1)),cmath.sqrt(cmath.add(cmath.opposite(cmath.multiply(t,t)),1)))),new Point(0,1)))},atan:function(t){return cmath.multiply(cmath.subtract(cmath.log(cmath.subtract(1,cmath.multiply(t,new Point(0,1)))),cmath.log(cmath.add(1,cmath.multiply(t,new Point(0,1))))),new Point(0,.5))}}});featureLoaders.push(function(){Date.Timer=function(){t._endOfTime=new Date("9999-12-30T00:00:00Z");function t(t){this.targetTime=t!=null?t:Date.Timer._endOfTime;this._counterValue=0;this._internalTimer=null;this._running=false;this.allowsEqual=true;this.precision=30;this.onArrive=eventField()}t.prototype.run=function(){if(this._running){return}this._counterValue=0;this._internalTimer=setInterval(function(t){return function(){var e,r;r=new Date;if(t.allowsEqual?r>=t.targetTime:r>t.targetTime){t._counterValue++;e=t.targetTime;t.targetTime=Date.Timer._endOfTime;return t.onArrive.fire({idealTime:e,nowTime:r,index:t._counterValue-1})}}}(this),this.precision);this._running=true;return this};t.prototype.stop=function(){if(!this._running){return}clearInterval(this._internalTimer);this._running=false;return this};t.prototype.getRunning=function(){return this._running};t.prototype.resetCounter=function(){return this._counterValue=0};t.prototype.getCounterValue=function(){return this._counterValue};return t}();return Date.IntervalTimer=function(t){__extends(e,t);function e(t,r,n){this.interval=t!=null?t:1e3;this.startTime=r!=null?r:new Date;this.endTime=n;e.__super__.constructor.call(this);this._started=false;this.includesStart=true;this.includesEnd=false;this.onStart=eventField();this.onArrive.bind(function(t){return function(e){t.targetTime=e.idealTime.add(t.interval);if(!t._started){t._started=true;if(!t.includesStart){t.resetCounter();e.blocksListeners=true}t.onStart.fire()}if(t.endTime!=null&&(t.includesEnd?t.targetTime>t.endTime:t.targetTime>=t.endTime)){return t.stop()}}}(this))}e.prototype.run=function(){if(this.getRunning()){return}this.targetTime=this.startTime;return e.__super__.run.call(this)};return e}(Date.Timer)});if(npmMate.environmentType==="browser"){window.npmMate=npmMate}else if(npmMate.environmentType==="node"){module.exports=npmMate}else{throw new Error}npmMate.packageInfo={name:"mate",version:"0.7.0",description:"New concept testing, array extensions, ES6 shim, etc. Small but all in one.",keywords:["test","unit","testing","event","coffeescript","timer","math","javascript","es6","js","coffee"],author:"Zhenzhen Zhan <zhanzhenzhen@hotmail.com>",homepage:"https://github.com/zhanzhenzhen/mate",licenses:[{type:"MIT",url:"https://github.com/zhanzhenzhen/mate/blob/master/LICENSE.txt"}],repository:{type:"git",url:"https://github.com/zhanzhenzhen/mate.git"},devDependencies:{"coffee-script":"1.7.1","uglify-js":"2.4.13"},main:"mate"}}).call(this);